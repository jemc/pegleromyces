
BasicSpec {
  name: "Parser"
  
  new_parser: Parser { }
  
  [tests]
  
  it "starts with a grammar that matches any string": {
    assert(new_parser.parse("xyz").result)
  }
  
  it "stores the resulting toplevel captures in results": {
    parser = new_parser
    parser.grammar = Patterns::Reduction {
      name: :root
      var inner: Patterns::NamedCapture {
        var name: :foo
        var inner: Patterns::AnyCharacter.new.*
      }
      new_environment: Patterns::Reduction::Environment {
        "!": "ABC_"foo"_123"
      }
    }
    
    parser.parse("xyz")
    assert_equal(parser.result.fetch(:root), "ABC_xyz_123")
  }
}
